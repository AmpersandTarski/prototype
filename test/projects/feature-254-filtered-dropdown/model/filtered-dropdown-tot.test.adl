-- ALL VARIABLES IN THIS SCRIPT NEEDS TO BE PREFIXED WITH CTXT ID BELOW AS 'CONTEXT' IS NOT OPERATIONAL YET IN ADL.
-- WE'LL NEED TO SEPARATE CONTEXT AS WE'LL HAVE MULTIPLE PAGE IN THIS TEST PROJECT USING THE SAME ATOMS NAMES AND
-- RELATIONS AND THEY WILL BE MIXED WITHOUT THIS PREFIX.
--
-- Define atoms with Capital like CtxTot and relations without like ctxTot

CONTEXT CtxTot

REPRESENT CtxTotName TYPE ALPHANUMERIC
REPRESENT CtxTotStatus TYPE ALPHANUMERIC

RELATION ctxTotEmployeeName[CtxTotEmployee*CtxTotName] [UNI]
RELATION ctxTotStatus[CtxTotEmployee*CtxTotStatus] [UNI]
RELATION ctxTotProjectMember[CtxTotProject*CtxTotEmployee] [TOT] -- at least one employee per project

POPULATION ctxTotEmployeeName[CtxTotEmployee*CtxTotName] CONTAINS
  [ ("m1", "Jan Jansen")
  , ("m2", "Piet Peters")
  , ("m3", "Marie Bakker")
  , ("m4", "Klaas Klaasen")
  , ("m5", "Anna Annasson")
  ]

POPULATION ctxTotStatus[CtxTotEmployee*CtxTotStatus] CONTAINS
  [ ("m1", "eligible")
  , ("m2", "on leave")
  , ("m4", "eligible")
  , ("m3", "fired")
  , ("m5", "eligible")
  ]

POPULATION ctxTotProjectMember[CtxTotProject*CtxTotEmployee] CONTAINS
  [ ("project 1", "m1")
  , ("project 2", "m1")
  , ("project 2", "m2")
  ]

-- Desired filtering: eligible employees only
RELATION ctxTotEligibleEmployee[CtxTotEmployee] [PROP]
ENFORCE ctxTotEligibleEmployee := ctxTotStatus;"eligible";ctxTotStatus~ /\ I
-- As a result, ctxTotEligibleEmployee contains [ ("m1","m1"), ("m4","m4"), ("m5","m5")]

-- I want the user to pick project members in the relation `ctxTotProjectMember`, using `ctxTotEligibleEmployee` to select from.

INTERFACE DropdownsTot : "_SESSION"[SESSION]; V[SESSION*CtxTotProject] cRUd BOX<FORM>
  [ "Project ID" : I
  , "Section Header" : TXT "ALL 8 VARIATIONS with the R permission"

  , "Assign an employee (cRud)" : ctxTotProjectMember cRud BOX<FILTEREDDROPDOWN>
  [ select : ctxTotEligibleEmployee ]  
  , "Assign an employee (cRUd)" : ctxTotProjectMember cRUd BOX<FILTEREDDROPDOWN>
  [ select : ctxTotEligibleEmployee ]  
  , "Assign an employee (cRuD)" : ctxTotProjectMember cRuD BOX<FILTEREDDROPDOWN>
  [ select : ctxTotEligibleEmployee ]  
  , "Assign an employee (cRUD)" : ctxTotProjectMember cRUD BOX<FILTEREDDROPDOWN>
  [ select : ctxTotEligibleEmployee ]  
  , "Assign an employee (CRud)" : ctxTotProjectMember CRud BOX<FILTEREDDROPDOWN>
  [ select : ctxTotEligibleEmployee ]  
  , "Assign an employee (CRUd)" : ctxTotProjectMember CRUd BOX<FILTEREDDROPDOWN>
  [ select : ctxTotEligibleEmployee ]  
  , "Assign an employee (CRuD)" : ctxTotProjectMember CRuD BOX<FILTEREDDROPDOWN>
  [ select : ctxTotEligibleEmployee ]  
  , "Assign an employee (CRUD)" : ctxTotProjectMember CRUD BOX<FILTEREDDROPDOWN>
  [ select : ctxTotEligibleEmployee ]

  , "Section Header 2" : TXT "One VARIATION without the R permission"
  , "Note" : TXT "(These result in: object is not readable, but also generate red box)"
  -- , "Assign an employee (crud)" : ctxTotProjectMember crud BOX<FILTEREDDROPDOWN>
  -- [ select : ctxTotEligibleEmployee ]
  ]
    

ENDCONTEXT
